{"paragraphs":[{"title":"Connect to Graph Server","text":"%pgx\nimport oracle.pgx.api.*\nimport groovy.json.*\n\nbaseUrl = \"http://{VM_IP_Address}:7007\"\nusername = \"RETAIL\"\npassword = \"{Retail_Password}\"\nkeystorePassword = \"{Keystore_Password}\"\n\nconn = new URL(\"$baseUrl/auth/token\").openConnection()\nconn.setRequestProperty('Content-Type', 'application/json')\ntoken = conn.with {\n  doOutput = true\n  requestMethod = 'POST'\n  outputStream.withWriter { writer ->\n    writer << JsonOutput.toJson([username: username, password: password])\n  }\n  return new JsonSlurper().parseText(content.text).access_token\n}\n\ninstance = Pgx.getInstance(baseUrl, token)\nsession = instance.createSession(\"my-session\")\nsession.registerKeystore(\"/zeppelin/oracle-pg/keystore.p12\", keystorePassword.toCharArray())\nanalyst = session.createAnalyst()","user":"anonymous","dateUpdated":"2020-10-28T05:25:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751966_-154045242","id":"20200820-130537_315823011","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:46:01+0000","dateFinished":"2020-10-28T04:46:03+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19501"},{"title":"Get Graph on Graph Server","text":"%pgx\ngraph = session.readGraphWithProperties(\"/graphs/config-tables.json\", \"Online Retail\")","user":"anonymous","dateUpdated":"2020-10-28T05:25:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751966_-1238495205","id":"20200615-133133_546539023","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:46:39+0000","dateFinished":"2020-10-28T04:46:48+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19502"},{"title":"Number of Product Nodes","text":"%pgx\ngraph.queryPgql(\"\"\"\n  SELECT COUNT(n)\n  MATCH (n:Product)\n\"\"\")","user":"anonymous","dateUpdated":"2020-10-28T04:55:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"COUNT(n)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751966_-927184936","id":"20200615-134001_1924995915","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:54:32+0000","dateFinished":"2020-10-28T04:54:33+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19503"},{"title":"Number of Customer Nodes","text":"%pgx\ngraph.queryPgql(\"\"\"\n  SELECT COUNT(n)\n  MATCH (n:Customer)\n\"\"\")","user":"anonymous","dateUpdated":"2020-10-28T04:56:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"COUNT(n)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751967_544727379","id":"20200615-134054_694875407","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:56:11+0000","dateFinished":"2020-10-28T04:56:11+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19504"},{"title":"Number of Purchase Edges","text":"%pgx\ngraph.queryPgql(\"\"\"\n  SELECT COUNT(e)\n  MATCH ()-[e:has_purchased]->()\n\"\"\")","user":"anonymous","dateUpdated":"2020-10-28T04:56:27+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"COUNT(e)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751967_944709718","id":"20200831-092005_486102885","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:56:27+0000","dateFinished":"2020-10-28T04:56:27+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19505"},{"title":"Number of Reverse Edges","text":"%pgx\ngraph.queryPgql(\"\"\"\n  SELECT COUNT(e)\n  MATCH ()-[e:purchased_by]->()\n\"\"\")","user":"anonymous","dateUpdated":"2020-10-28T04:56:43+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":84,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"COUNT(e)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751967_1048914774","id":"20200831-125901_2095314547","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:56:43+0000","dateFinished":"2020-10-28T04:56:43+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19506"},{"title":"Find a Customer with a Few Purchases","text":"%pgx\ngraph.queryPgql(\"\"\"\n  SELECT ID(c), COUNT(*)\n  FROM MATCH (c:Customer)->(p)\n  GROUP BY ID(c)\n  ORDER BY COUNT(*) ASC\n  LIMIT 10\n\"\"\")","user":"anonymous","dateUpdated":"2020-10-28T05:15:39+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ID(c)":"string","COUNT(*)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751967_-542017302","id":"20200831-131208_1778087226","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T05:15:40+0000","dateFinished":"2020-10-28T05:15:41+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19507"},{"title":"Products Purchased by this Customer","text":"%pgx\ngraph.queryPgql(\"SELECT ID(c), ID(p), p.description FROM MATCH (c)->(p) WHERE ID(c) = 'cust_12353'\")","user":"anonymous","dateUpdated":"2020-10-28T04:57:19+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":182,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ID(c)":"string","ID(p)":"string","description":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751968_-528735336","id":"20200831-123621_190727453","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:57:19+0000","dateFinished":"2020-10-28T04:57:20+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19508"},{"title":"Run Personalized PageRank (PPR)","text":"%pgx\nrs = graph.queryPgql(\"SELECT c MATCH (c:Customer) WHERE ID(c) = 'cust_12353'\")\nrs.next()\nvertex = rs.getVertex(1)\nanalyst.personalizedPagerank(graph, vertex)","user":"anonymous","dateUpdated":"2020-10-28T04:57:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751968_-1211976121","id":"20200615-133156_2005042788","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:57:34+0000","dateFinished":"2020-10-28T04:57:35+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19509"},{"title":"Get Top 10 Recommendations","text":"%pgx\ngraph.queryPgql(\"\"\"\n  SELECT ID(p), p.description, p.pagerank\n  MATCH (p)\n  WHERE LABEL(p) = 'Product'\n    AND NOT EXISTS (\n      SELECT *\n      MATCH (p)-[:purchased_by]->(c)\n      WHERE ID(c) = 'cust_12353'\n    )\n  ORDER BY p.pagerank DESC\n  LIMIT 10\n\"\"\")","user":"anonymous","dateUpdated":"2020-10-28T04:57:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ID(p)":"string","p.pagerank":"string","p.description":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751968_1156818990","id":"20200615-133607_1436961549","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:57:53+0000","dateFinished":"2020-10-28T04:57:54+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19510"},{"title":"Paths to the Top Recommended Product","text":"%pgx\ngraph.queryPgql(\"\"\"\n  SELECT ID(c), ARRAY_AGG(ID(n1)), ARRAY_AGG(ID(e)), ID(p)\n  FROM MATCH TOP 10 SHORTEST ( (c) ((n1) -[e]-> (n2))* (p) )\n  WHERE ID(c) = 'cust_12353'\n    AND ID(p) = 'prod_23166'\n\"\"\")","user":"anonymous","dateUpdated":"2020-10-28T04:58:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"ID(c)":"string","ARRAY_AGG(ID(n1))":"string","ARRAY_AGG(ID(e))":"string","ID(p)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751968_-240732582","id":"20200615-133908_161787886","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:58:15+0000","dateFinished":"2020-10-28T04:58:17+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19511"},{"title":"Intermediate Nodes","text":"%pgx\ngraph.queryPgql(\"\"\"\n  SELECT DISTINCT p1.description, COUNT(*) AS num_c2\n  MATCH (c1)->(p1)<-(c2)->(p2)\n  WHERE ID(c1) = 'cust_12353'\n    AND ID(p2) = 'prod_23166'\n    AND ID(c1) != ID(c2)\n    AND ID(p2) != ID(p1)\n  GROUP BY p1.description\n\"\"\")\n","user":"anonymous","dateUpdated":"2020-10-28T04:58:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":168,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"p1.description":"string","num_c2":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751969_231230598","id":"20200615-140203_1439868301","dateCreated":"2020-10-28T04:35:51+0000","dateStarted":"2020-10-28T04:58:37+0000","dateFinished":"2020-10-28T04:58:38+0000","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19512"},{"text":"%md\nEnd of Document\n\n---","user":"anonymous","dateUpdated":"2020-10-28T04:35:51+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1603859751969_-1829896518","id":"20200615-140501_815191974","dateCreated":"2020-10-28T04:35:51+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19513"}],"name":"Online Retail","id":"2FN5CYQT1","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"pgx:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}